---
title: "Discrete Choice Models in GLMcat"

author:
  - Lorena León^[Université de Montpellier, ylorenaleonv@gmail.com]
  - Jean Peyhardi^[Université de Montpellier, jean.peyhardi@umontpellier.fr]
  - Catherine Trottier^[Université de Montpellier, catherine.trottier@umontpellier.fr]

abstract: |
  Abstract
  
output: rmarkdown::pdf_document
bibliography: bibliography_vignette.bib
vignette: >
  %\VignetteIndexEntry{Discrete Choice Models in GLMcat}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r }
library(GLMcat)
```

### Dataset

The choice of travel mode of n = 210 passengers in Australia was investigated by @louviere_2000, @greene2003econometric and @tutz_2011. The alternatives of travel mode are: air, train, bus, and car. As $category-specific$ variables they considered the travel time in vehicle *(invt)* and the general cost *(gc)*, and, as the $global-variables$ they considered the household income *(hinc)*, and the number of people traveling *(psize)*.
As example data, `GLMcat` includes the database: `TravelChoice`; which we can load as follows:

```{r }
data("TravelChoice")
head(TravelChoice)
str(TravelChoice)
```

To execute the model proposed by @tutz_2011 (Example 8.4), we execute the `Discrete_CM ` function with the specific parameters as follows:

```{r }
exp_8.4 <- Discrete_CM(
  formula = choice ~ hinc + gc + invt,
  case_id = "indv",
  alternatives = "mode",
  reference = "air",
  data = TravelChoice,
  alternative_specific = c("gc", "invt"),
  distribution = "logistic")
```

The reported estimates given in Table 8.4 correspond to the output:

```{r }
summary(exp_8.4)
```

According with @tutz_2011, the income seems to be influential for the preference of train and bus over airplane. And, time in vehicle seems to have an impact for the choice of travel mode. Also, cost turns out to be non-influential if income is in the predictor.

### Table 6.2. from @louviere_2000

Constants only model

```{r }
(constant_model <- Discrete_CM(
  formula = choice ~ 1 ,
  case_id = "indv",
  alternatives = "mode",
  reference = c("air", "train", "bus", "car"),
  data = TravelChoice,
  distribution = "logistic"
))

(car_0 <- Discrete_CM(
  formula = choice ~ hinc[air] + psize[air] + gc + ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = c("air", "train", "bus", "car"),
  alternative_specific = c("gc", "ttme"),
  data = TravelChoice,
  distribution = "logistic"
))
```

### The results reported by @PEYHARDI_choice
Student (3), air, LogLik = -185.65

```{r }
(air_30 <- Discrete_CM(
  formula = choice ~ hinc[air] + psize[air] + gc + ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "air",
  alternative_specific = c("gc", "ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = 3
))
```

Student (30), bus, LogLik = -183.79

```{r }
(bus_30 <- Discrete_CM(
  formula = choice ~ hinc[air] + psize[air] + gc + ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "bus",
  alternative_specific = c("gc", "ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = 30
))
```

Student (0.2), car, LogLik = -142

```{r }
(car_.2 <- Discrete_CM(
  formula = choice ~ hinc[air] + psize[air] + gc + ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "car",
  alternative_specific = c("gc", "ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = 0.2
))
```

Student (1.35), train, LogLik = -183.49

```{r }
(train_1.35 <- Discrete_CM(
  formula = choice ~ hinc[air] + psize[air] + gc + ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "train",
  alternative_specific = c("gc", "ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = 1.35
))
```

The results are clearly in favour of the reference alternative $j_0 =car$ since the gain in LogLikelihood is *43.92* compared to the multinomial logit model (MNL) results, i.e., *24%* of the LogLikelihood. It is a very huge difference compared to the results given in the literature ([@louviere_2000]; [@greene2003econometric]), obtained with MNL and with the nested model. 
Additional results presented by @PEYHARDI_choice


```{r }
(table_4 <- Discrete_CM(
  formula = choice ~ ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "car",
  alternative_specific = "ttme",
  data = TravelChoice,
  distribution = "logistic"
))
# AIC(table_4)
```

#### Table 2 (without normalized space)

```{r }
(car_.2 <- Discrete_CM(
  formula = choice ~ hinc[air] + psize[air] + gc + ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "car",
  alternative_specific = c("gc", "ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = 0.45
))
# logLik(car_.2)
```

#### Table 4 (without normalized space)

```{r }
(car_8 <- Discrete_CM(
  formula = choice ~  ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "car",
  alternative_specific = c("ttme"),
  data = TravelChoice,
  distribution = "logistic"
))
# logLik(car_8)
```

#### Table 5 (without normalized space)

```{r }
(car_.45 <- Discrete_CM(
  formula = choice ~  ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "car",
  alternative_specific = c("ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = .45
))
# logLik(car_.45)
```

#### Table 6 (without normalized space)

```{r }
(car_.05 <- Discrete_CM(
  formula = choice ~  ttme,
  case_id = "indv",
  alternatives = "mode",
  reference = "car",
  alternative_specific = c("ttme"),
  data = TravelChoice,
  distribution = "student",
  freedom_degrees = .05
))
```

### References

